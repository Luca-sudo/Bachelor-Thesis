\chapter{Unit Test Functions}

\begin{figure}[H]
   \begin{minted}{ocaml}
      def add1 l = match l with 
	 | nil -> nil
	 | cons(x, xs) -> let _ = tick 1 in			  let x' = x + 1 in
			  let xs' = add1 xs in
			  cons(x', xs')
   \end{minted}
   \caption{add1 :: \(\ralist{}{\typeint} \to \ralist{}{\typeint}\)}
\label{fig:code-add1}
\end{figure}

\begin{figure}[H]
   \begin{minted}{ocaml}
      def sum l n = match l with 
	 | nil -> n
	 | cons(x, xs) -> let _ = tick 2 in 
			  let x' = n + x in
			  sum xs x'
   \end{minted}
   \caption{sum :: \(\ralist{}{\typeint} \to \typeint \to \typeint\)}
\label{fig:code-sum}
\end{figure}

\begin{figure}[H]
   \begin{minted}{ocaml}
      def map f l = match l with
	 | nil -> nil
	 | cons(x, xs) -> let x' = f x in
			  let xs' = map f xs in
			  conx(x', xs')
   \end{minted}
   \caption{map :: \((A \to B) \to \ralist{}{A} \to \ralist{}{B}\)}
\label{fig:code-map}
\end{figure}

\begin{figure}[H]
   \begin{minted}{ocaml}
      def fold op l acc = match l with
	 | nil -> acc
	 | cons(x, xs) -> let acc' = op acc x in 
			  fold op xs acc'
      \end{minted}
   \caption{fold :: \((A \to B \to B) \to \ralist{}{A} \to B \to B\)}
\label{fig:code-fold}
\end{figure}

